{"version":3,"file":"content.js","mappings":"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","sources":["webpack://smart-fit/./src/content/content.js","webpack://smart-fit/./src/content/styles/content.css?6c03","webpack://smart-fit/webpack/bootstrap","webpack://smart-fit/webpack/runtime/harmony module decorator","webpack://smart-fit/webpack/runtime/make namespace object","webpack://smart-fit/webpack/before-startup","webpack://smart-fit/webpack/startup","webpack://smart-fit/webpack/after-startup"],"sourcesContent":["import './styles/content.css';\n\n// Amazon Fresh product selectors\nconst PRODUCT_SELECTORS = {\n  // Product title selectors\n  title: [\n    '#productTitle',\n    '[data-testid=\"product-title\"]',\n    '.product-title-word-break',\n    '.a-size-large.product-title-word-break',\n    '.a-text-bold'\n  ],\n  // Brand/Product info\n  brand: '.brand-store-link',\n  // Amazon Fresh specific selectors\n  freshTitle: '[data-testid=\"product-title\"]',\n  freshBrand: '[data-testid=\"product-brand\"]'\n};\n\nclass ProductAnalyzer {\n  constructor() {\n    this.analysisCache = new Map();\n    this.setupObservers();\n  }\n\n  setupObservers() {\n    // Observer for URL changes (SPA navigation)\n    const observer = new MutationObserver((mutations) => {\n      if (window.location.href !== this.lastUrl) {\n        this.lastUrl = window.location.href;\n        this.checkAndAnalyze();\n      }\n    });\n\n    observer.observe(document.body, {\n      childList: true,\n      subtree: true\n    });\n\n    this.lastUrl = window.location.href;\n  }\n\n  // In your analyze() method of ProductAnalyzer class\n  async analyze() {\n    try {\n      console.log('Starting product analysis...');\n\n      const currentUrl = window.location.href;\n      if (this.analysisCache.has(currentUrl)) {\n        console.log('Cache hit:', this.analysisCache.get(currentUrl));\n        return this.analysisCache.get(currentUrl);\n      }\n\n      const productInfo = await this.extractProductInfo();\n      console.log('Extracted product info:', productInfo);\n\n      const analysisData = {\n        ...productInfo,\n        url: currentUrl,\n        timestamp: new Date().toISOString()\n      };\n\n      this.analysisCache.set(currentUrl, analysisData);\n      console.log('Sending to background script:', analysisData);\n\n      // Send message and wait for response\n      const response = await chrome.runtime.sendMessage({\n        type: 'ANALYZE_PRODUCT',\n        data: analysisData\n      });\n\n      console.log('Received response from background:', response);\n      return analysisData;\n\n    } catch (error) {\n      console.error('Analysis error:', error);\n      throw error;\n    }\n  }\n\n  async extractProductInfo() {\n    try {\n      // Try all possible title selectors\n      let title = null;\n      for (const selector of PRODUCT_SELECTORS.title) {\n        const element = document.querySelector(selector);\n        if (element) {\n          title = element.textContent.trim();\n          break;\n        }\n      }\n\n      // Try Fresh specific selector if no title found\n      if (!title) {\n        const freshTitle = document.querySelector(PRODUCT_SELECTORS.freshTitle);\n        if (freshTitle) {\n          title = freshTitle.textContent.trim();\n        }\n      }\n\n      if (!title) {\n        throw new Error('Could not find product title');\n      }\n\n      // Get brand info\n      let brand = document.querySelector(PRODUCT_SELECTORS.brand)?.textContent?.trim() ||\n                 document.querySelector(PRODUCT_SELECTORS.freshBrand)?.textContent?.trim();\n\n      // If no explicit brand found, try to extract from title\n      if (!brand && title) {\n        const parts = title.split(' ');\n        brand = parts[0]; // Usually, brand is the first word\n      }\n\n      // Get category from URL or breadcrumb\n      const category = this.extractCategory();\n\n      return {\n        title,\n        brand,\n        category,\n        searchQuery: this.createSearchQuery(title, brand)\n      };\n    } catch (error) {\n      console.error('Error extracting product info:', error);\n      throw error;\n    }\n  }\n\n  createSearchQuery(title, brand) {\n    // Clean up title for better search results\n    let query = title\n      .replace(/\\([^)]*\\)/g, '') // Remove parentheses and their contents\n      .replace(/,/g, '') // Remove commas\n      .replace(/\\s+/g, ' ') // Normalize spaces\n      .trim();\n\n    // Add brand if it's not already in the title\n    if (brand && !title.toLowerCase().includes(brand.toLowerCase())) {\n      query = `${brand} ${query}`;\n    }\n\n    // Limit query length for API\n    return query.slice(0, 100);\n  }\n\n  extractCategory() {\n    // Try to get category from breadcrumb\n    const breadcrumb = document.querySelector('.a-breadcrumb');\n    if (breadcrumb) {\n      const categories = Array.from(breadcrumb.querySelectorAll('a'))\n        .map(a => a.textContent.trim().toLowerCase());\n\n      // Define category mapping\n      const categoryMap = {\n        'produce': 'fresh produce',\n        'dairy': 'dairy',\n        'meat': 'meat',\n        'seafood': 'seafood',\n        'bakery': 'bakery',\n        'beverages': 'beverages',\n        'snacks': 'snacks'\n      };\n\n      // Find matching category\n      for (const [key, value] of Object.entries(categoryMap)) {\n        if (categories.some(cat => cat.includes(key))) {\n          return value;\n        }\n      }\n    }\n\n    // Try to get from URL\n    const url = window.location.pathname.toLowerCase();\n    if (url.includes('/fresh/')) {\n      return 'fresh food';\n    }\n    if (url.includes('/grocery/')) {\n      return 'grocery';\n    }\n\n    return 'food';\n  }\n\n  checkAndAnalyze() {\n    // Only analyze if we're on a product page\n    if (this.isProductPage()) {\n      this.analyze()\n        .then(data => {\n          chrome.runtime.sendMessage({\n            type: 'ANALYZE_PRODUCT',\n            data: data\n          });\n        })\n        .catch(error => console.error('Analysis failed:', error));\n    }\n  }\n\n  isProductPage() {\n    // Check if any product title selector matches\n    return PRODUCT_SELECTORS.title.some(selector =>\n      document.querySelector(selector)\n    ) || document.querySelector(PRODUCT_SELECTORS.freshTitle);\n  }\n}\n\n// Initialize analyzer\nconst analyzer = new ProductAnalyzer();\n\n// Handle messages\nchrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\n  console.log(\"Content script received message:\", request);\n\n  switch (request.type) {\n    case 'ANALYZE_REQUEST':\n      analyzer.analyze()\n        .then(response => sendResponse({ data: response }))\n        .catch(error => sendResponse({ error: error.toString() }));\n      return true;\n\n    case 'PING':\n      sendResponse({ status: 'alive' });\n      return false;\n  }\n\n  return false;\n});\n\n// Export for testing\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = { ProductAnalyzer };\n}","// extracted by mini-css-extract-plugin\nexport {};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/content/content.js\");\n",""],"names":["PRODUCT_SELECTORS","title","brand","freshTitle","freshBrand","ProductAnalyzer","constructor","analysisCache","Map","setupObservers","observer","MutationObserver","mutations","window","location","href","lastUrl","checkAndAnalyze","observe","document","body","childList","subtree","analyze","console","log","currentUrl","has","get","productInfo","extractProductInfo","analysisData","url","timestamp","Date","toISOString","set","response","chrome","runtime","sendMessage","type","data","error","selector","element","querySelector","textContent","trim","Error","parts","split","category","extractCategory","searchQuery","createSearchQuery","query","replace","toLowerCase","includes","slice","breadcrumb","categories","Array","from","querySelectorAll","map","a","categoryMap","key","value","Object","entries","some","cat","pathname","isProductPage","then","catch","analyzer","onMessage","addListener","request","sender","sendResponse","toString","status","module","exports"],"sourceRoot":""}